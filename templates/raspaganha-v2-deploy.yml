# üéÆ Deploy RaspaGanha V2 - Deploy com Rollback Autom√°tico
# 
# Configura√ß√£o espec√≠fica para o projeto raspaganha-v2
# Otimizado para plataforma de jogos e raspadinhas

name: Deploy RaspaGanha V2

on:
  push:
    branches: [main, master]
  workflow_dispatch:

jobs:
  deploy:
    uses: GatHubPay/vercel-rollback-workflows/.github/workflows/vercel-rollback.yml@main
    with:
      # ‚¨áÔ∏è OBRIGAT√ìRIO: Nome correto do projeto no Vercel (confirmado na URL)
      vercelProject: "rasparei"
      
      # ‚¨áÔ∏è ROTAS B√ÅSICAS PARA EVITAR FALSOS POSITIVOS
      routes: "/,/api/health"
      
      # ‚¨áÔ∏è CONFIGURA√á√ïES CONSERVADORAS PARA DEBUGGING
      healthCheckTimeout: 45        # Timeout padr√£o
      maxRetries: 3                 # Tentativas padr√£o
      enablePostDeployMonitoring: false # Desabilitado para debugging
      
    secrets:
      VERCEL_TOKEN: ${{ secrets.VERCEL_TOKEN }}
      VERCEL_TEAM_ID: ${{ secrets.VERCEL_TEAM_ID }}
      VERCEL_SCOPE: ${{ secrets.VERCEL_SCOPE }}
      TELEGRAM_BOT_TOKEN: ${{ secrets.TELEGRAM_BOT_TOKEN }}
      TELEGRAM_CHAT_ID: ${{ secrets.TELEGRAM_CHAT_ID }}

# ========================================
# CONFIGURA√á√ïES ESPEC√çFICAS RASPAGANHA V2
# ========================================
#
# CORRE√á√ïES APLICADAS:
# ‚úÖ Nome do projeto corrigido: "raspaganha-v2"
# ‚úÖ Timeout aumentado para 60s (era 45s)
# ‚úÖ MaxRetries aumentado para 5 (era 4)
# ‚úÖ Rotas simplificadas para evitar falsos positivos
# ‚úÖ Monitoramento reduzido para 30min (era 45min)
#
# ROTAS TESTADAS:
# / - P√°gina principal
# /api/health - Health check (OBRIGAT√ìRIO)
# /login - P√°gina de login
# /jogos - Cat√°logo de jogos
# /raspadinhas - Sistema de raspadinhas
# /carteira - Gest√£o financeira
# /perfil - Perfil do usu√°rio
#
# ========================================
